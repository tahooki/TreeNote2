<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Get</title>

  <!-- Bootstrap -->
<link href="../../resources/css/bootstrap.css" rel="stylesheet" type="text/css"/>

<!-- jQuery를 사용하기위해 jQuery라이브러리 추가 -->
<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
</head>
<body>
                    	
<div id="contentContainer">
    <div id="table" style="width:577px; margin-left:27px;"> 
      <div id="line1" style="width:577px; border-bottom-style: dashed; border-bottom-color: gainsboro; height: 42.5px;margin-top: 10px;">
         <div id="lineL" style="width: 340px; height:40px; position: relative;float: left;margin-left: 5px;margin-top: 2px;">
            <div id="keywordd" style="float: left; font-family: Jeju Gothic; font-size: 23px; font-weight: bold;max-width: 203px; height:30px; letter-spacing: 5px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;margin-top: 2px;" class="keywordd"></div> 
            <div style="float: left; font-family: Jeju Gothic; font-size: 15px; font-weight: bold; opacity: 0.90;margin-top: 12px; margin-left:5px;"> | </div>
            <div style="float: left; font-family: Jeju Gothic; font-size: 15px; font-weight: bold; opacity: 0.90;margin-top: 12px;margin-left: 3px;"> by </div>
            <div style="float: left; font-family: Jeju Gothic; font-size: 15px; font-weight: bold; opacity: 0.90; width: 100px;margin-left: 6px;margin-top: 12px;overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" id="name"></div>
         </div>

         <div id="line1R" style="width: 180px;float: right;margin-top: 17px;margin-right: 7px;">
            <font id="delete" style="font-size: 14px; font-family: Jeju Gothic; float: right; margin-top:-2px; cursor:pointer;">삭제</font> 
            <font style="font-size: 14px; font-family: Jeju Gothic; float: right;margin-right: 3px; margin-top:-2px; ">|</font> 
            <font id="update" style="font-size: 14px; font-family: Jeju Gothic; float: right; cursor:pointer;margin-right: 5px; margin-top:-2px;" onclick="location.href='update.html'">수정</font> 
            <font style="font-size: 14px; font-family: Jeju Gothic; float: right;margin-right: 3px; margin-top:-2px; ">|</font> 
            
            <div id="DATE" style="width: 85px;">
               <font style="text-align: left; font-family: Jeju Gothic; font-size: 13px; opacity: 0.75; float: right;margin-top: -1px;margin-right: -13px;" id="bcd"></font>
            </div>
         </div>
      </div>

      <div id="line2" style="position: relative;height: 30px; margin-top: 10px;margin-left: 8px;">
         <div id="line2L" style="width: 270px;  font-weight: bold; float: left; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
            <font style="text-align: left; font-family: Jeju Gothic; font-size: 16px; width: 100px; margin-left:1px;">출</font>
            <font style="text-align: left; font-family: Jeju Gothic; font-size: 16px; width: 100px;margin-left: 5px;">처</font>
            <font style="text-align: left; font-family: Jeju Gothic; font-size: 15px; width: 100px;margin-left: 1px;">|</font>
            <font id="userName" style="text-align: left; font-family: Jeju Gothic; font-size: 15px; width: 100px;margin-left: 1px;" ></font>
         </div>
         
         <div id="line2R" style="width: 250px; float: right; opacity: 0.75; font-size: 13px;">
            <font id="scrap" style="float: right; margin-right: 15px;">스크랩수<span class="badge" id="scrapNo" style="margin-left: 5px; padding-bottom: 1.5px; padding-top: 1.5px; padding-left: 5px; padding-right: 5px;"></span></font>   
            <font id="sourceMore" style="cursor:pointer;float: right; margin-right: 10px;">출처보기</font>
         </div>         
      </div>
      
      <div id="content" style="margin-top:10px"></div>
   </div>
</div>	



	<script type="text/javascript">
		$(function() {
			
			var keywordNo = sessionStorage.getItem("keywordNo");
//			console.log(keywordNo);
			$(".keywordNo").text(keywordNo);
			
			var keyword = sessionStorage.getItem("keyword");
//			console.log("111111111111111111 "+keyword);
			var keywordd = keyword.replace(/"/g, "");
//			console.log(keywordd);
			$(".keywordd").text(keywordd);

// 			var keywordUser = sessionStorage.getItem("keywordUser");
// 			console.log(keywordUser);
// 			$(".keywordUser").text(keywordUser);	

			$.getJSON("/content/getContent/" +keywordNo, function(data) {
 				console.log(data.content.content);
 				console.log(data.content.regTime);
 				console.log(data);
 				console.log(data.user);
 				console.log(data.user.userNo);
 				console.log(data.userNo);
 				console.log(data.user.name);
 				console.log("scrap "+data.content.scrap);
				
				var userNo = data.user.userNo;
				var name = data.user.name;
				var regTime = new Date();
				regTime.setTime(data.content.regTime);
				
			    var time = regTime.toTimeString().substring(0,8);
			    var date = regTime.toISOString().substring(0,10);
			    
			    var scrap = data.content.scrap;
			    
			    if(data.user.userNo!=data.userNo){
					$(".button").hide();
				}
			    
//			    console.log("날짜 :: "+date+" 시간 :: "+time );

//				console.log("4444444");
//				console.log(data.originUserList);
				if(data.originUserList.length > 0){	
					for(var i = 0; i < data.originUserList.length ; i++){					
					console.log("55555");
				    console.log();
				    var sendoo1 = "<font class='name' style='cursor:pointer' title='"+data.originUserList[i].user+"'>"
				    				+data.originUserList[i].name+
				    				"</font>";
				    				
				    var sendoo2 = "<font class='name' style='cursor:pointer' title='"+data.originUserList[i].user+"'>"
    								+data.originUserList[i].name+
    								"</font>"+" -> ";   								   								
    								
					if(i==data.originUserList.length-1 || data.originUserList.length==1){
						$("#userName").append(sendoo1);	
					}else{
						$("#userName").append(sendoo2);	
					}
				}
				    
			}
				    
			    			    
			    $("#userNo").append(userNo);
			    $("#name").append(name);
				$(data.content.content).appendTo("#content");
				var DT = date.replace(/-/g,".").substring(2,date.length);
				var Time = time.substring(0,5);
				console.log("date "+date +"time "+time);
				$("#bcd").append(DT+" "+ Time);
				$("#scrapNo").text(scrap);
				
							
			});
			
		
			
			$("#delete").click(function(){
				var answer = confirm("내용을 삭제하시겠습니까?");
				if(answer){
					document.write(answer);
							
					var content = $("iframe").contents().find("#se2_iframe").contents().find("html").html(); 
				
					$.ajax( 
					{
						url : "/content/removeContent/" +keywordNo,
						method : "POST" ,
						dataType : "json" ,
						data: JSON.stringify({
							keywordNo : keywordNo,
							content : content,						
						}),
						headers : {
							"Accept" : "application/json",
							"Content-Type" : "application/json"
						},
						success : function(JSONData , status) {
							parent.location.href='../main.html';
						}
					});
				}else{

				}				
			});
			
			
		});
	</script>
</body>
</html>