<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Get</title>

  <!-- Bootstrap -->
<link href="../../resources/css/bootstrap.css" rel="stylesheet" type="text/css"/>

<!-- jQuery를 사용하기위해 jQuery라이브러리 추가 -->
<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
</head>
<body>

 <!-- 좌우측의 공간 확보 -->
<!--         <div class="container"> -->
<!--             <hr/> -->
<!--             <div class="row"> -->
<!--                 <div class="col-md-10"> -->
                    <table class="table table-condensed" style="width:85%; margin-left:47px;">
                        <thead>
                            <tr >
                                <th width="25%" style="text-align:center; font-family:Jeju Gothic; font-size: 20px; font-weight:bold;" class="keywordd"></th>
                                <th width="30%" style="text-align:left; text-align:right;" id="Name"></th>                            	
                            </tr>
                        </thead>
                        <tbody>
                                          
                            <tr>
                                <td style="text-align:center">출처
                                
                                </td>
                                <td id="UserName" style="text-align:left">
                                
                                </td>
                            </tr>
                            
                            <tr>
                                <td style="text-align:center">Date 
                                </td>
                                <td id="bcd" style="text-align:left"> <span style='float:right'> Scrap : 0</span>
                                </td>
                            </tr>
                            
                            
                            <tr>
                                <td colspan="2" id="abc">
                       
                                </td>
                            </tr>
                        </tbody>
                       
                    </table>

                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <td>
                                    <span style='float:right; margin-right:50px;' class="button">
                                        <button type="button" id="modify" class="btn btn-default" onclick="location.href='update.html'">수정</button>
                                        <button type="button" id="delete" class="btn btn-default" >삭제</button>
                                    </span>
                                </td>
                            </tr>
                        </thead>
                    </table>

	<div id="test"></div>

	<script type="text/javascript">
		$(function() {
			
			var keywordNo = sessionStorage.getItem("keywordNo");
//			console.log(keywordNo);
			$(".keywordNo").text(keywordNo);
			
			var keyword = sessionStorage.getItem("keyword");
//			console.log("111111111111111111 "+keyword);
			var keywordd = keyword.replace(/"/g, "");
//			console.log(keywordd);
			$(".keywordd").text(keywordd);

// 			var keywordUser = sessionStorage.getItem("keywordUser");
// 			console.log(keywordUser);
// 			$(".keywordUser").text(keywordUser);	

			$.getJSON("/content/getContent/" +keywordNo, function(data) {
 				console.log(data.content.content);
 				console.log(data.content.regTime);
 				console.log(data);
 				console.log(data.user);
 				console.log(data.user.userNo);
 				console.log(data.userNo);
 				console.log(data.user.name);
				
				var UserNo = data.user.userNo;
				var Name = data.user.name;
				var regTime = new Date();
				regTime.setTime(data.content.regTime);
				
			    var time = regTime.toTimeString().substring(0,8);
			    var date = regTime.toISOString().substring(0,10);
			    
			    if(data.user.userNo!=data.userNo){
					$(".button").hide();
				}
			    
//			    console.log("날짜 :: "+date+" 시간 :: "+time );

//				console.log("4444444");
//				console.log(data.originUserList);
				if(data.originUserList.length > 0){	
//					for(var i = 0; i < data.originUserList.length ; i++){					
					console.log("55555");
				    console.log();
				    var sendoo = "<font class='name' title='"+data.originUserList[0].userNo+"'>"
				    				+data.originUserList[0].name+
				    				"님의 Content를 공유했습니다."+"</font>";
				    				
 				    //var UserName = data.originUserList[0].name+"님의 Content를 공유했습니다.";
				    console.log("요기요기요기 "+UserName);
 				    $("#UserName").append(sendoo);				  
//					alert($(".name").attr("title"));
 				    
				}
			    
			    			    
			    $("#No").append(UserNo);
			    $("#Name").append(Name);
				$(data.content.content).appendTo("#abc");
				var DT = date.replace(/-/g,".").substring(2,date.length);
				var Time = time.substring(0,5);
				console.log("date "+date +"time "+time);
				$("#bcd").append(DT+" "+ Time);
							
			});	
			
			
			$("#delete").click(function(){
				var answer = confirm("내용을 삭제하시겠습니까?");
				if(answer){
					document.write(answer);
							
					var content = $("iframe").contents().find("#se2_iframe").contents().find("html").html(); 
				
					$.ajax( 
					{
						url : "/content/removeContent/" +keywordNo,
						method : "POST" ,
						dataType : "json" ,
						data: JSON.stringify({
							keywordNo : keywordNo,
							content : content,						
						}),
						headers : {
							"Accept" : "application/json",
							"Content-Type" : "application/json"
						},
						success : function(JSONData , status) {
							parent.location.href='../main.html';
						}
					});
				}else{

				}				
			});
			
			
		});
	</script>
</body>
</html>